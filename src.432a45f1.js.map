{"version":3,"sources":["index.js"],"names":["$","id","document","getElementById","clearMsg","value","showSYS","data","len","i","lt","insertText","SYSDATA","window","current_LT","ssbps","showEEPROM","str","toString","ptr","j","k","innerText","act","editCmd","kM","paramCnt","res_wifi","terminal_scroll","terminal_log","previous_LT","lost","flag_lost","device","wifi","RSSI","LT","bps","SSbps","ILWPR","ILWPSH","OLWPR","OLWPSH","PumpILStart","PumpILStartActID","PumpILStop","SMFull","SML","SMLActT","SMZero","STMODE","Stations","FoehnHum","foehnOpT","FoehnTemp","Sched","postCmd","jsonCmd","SENDCMD","console","log","worker","postMessage","error","wkMsg","e","Uint8Array","undefined","dataFormatEntryPoint","classList","remove","add","spin","flag","spinOnlyIcon"],"mappings":"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","file":"src.432a45f1.js","sourceRoot":"../src","sourcesContent":["window.act;\nwindow.editCmd = 0;\nwindow.kM;\nwindow.paramCnt = 0;\nwindow.res_wifi = \"\";\nwindow.terminal_scroll = true;\nwindow.terminal_log = true;\nwindow.current_LT = 0;\nwindow.previous_LT = 0;\nwindow.lost = 0;\nwindow.flag_lost = false;\nwindow.SYSDATA = {\n  device: \"-\",\n  wifi: \"\",\n  RSSI: \"\",\n  LT: 0,\n  bps: 0,\n  SSbps: 0,\n  ILWPR: \"\",\n  ILWPSH: \"\",\n  OLWPR: \"\",\n  OLWPSH: \"\",\n  PumpILStart: \"\",\n  PumpILStartActID: \"\",\n  PumpILStop: \"\",\n  SMFull: \"\",\n  SML: \"\",\n  SMLActT: \"\",\n  SMZero: \"\",\n  STMODE: \"\",\n  Stations: 0,\n  FoehnHum: \"\",\n  foehnOpT: \"\",\n  FoehnTemp: \"\",\n  Sched: [],\n};\n\nwindow.postCmd = function postCmd(str) {\n  if (str === \"\") return;\n  let jsonCmd = { SENDCMD: str };\n  console.log(jsonCmd);\n  if (!window.worker) {\n    console.log(\"websocket not ready...\");\n    return;\n  }\n  try {\n    window.worker.postMessage(jsonCmd);\n  } catch (error) {\n    console.log(error);\n  }\n};\n\nfunction $(id) {\n  return document.getElementById(id);\n}\n\nwindow.wkMsg = function wkMsg(e) {\n  try {\n    if (e.data instanceof Uint8Array) {\n      e.data[0] === 0x00\n        ? showSYS(e.data)\n        : e.data[0] === 0x01\n        ? showEEPROM(e.data)\n        : 0;\n    }\n\n    if (window.dataFormatEntryPoint !== undefined) {\n      window.dataFormatEntryPoint(e.data);\n    }\n\n    if (e.data.RSSI === \"<---->\") {\n      window.lost++;\n    } else if (e.data.RSSI) {\n      window.lost--;\n    }\n\n    if (window.lost > 1) {\n      window.lost = 1;\n      console.log(\"lost connection\");\n      $(\"status_light\").classList.remove(\"light-green\");\n\n      if (!flag_lost) {\n        flag_lost = true;\n        // alert(\"連接異常，請重新整理網頁、檢查Wifi或重啟設備。\");\n        console.log(\"連接異常，請重新整理網頁、檢查Wifi或重啟設備。\");\n      }\n    } else {\n      flag_lost = false;\n      $(\"status_light\").classList.add(\"light-green\");\n    }\n  } catch (error) {\n    console.log(error);\n  }\n};\nfunction clearMsg() {\n  $(\"tx\").value = \"\";\n}\n\nfunction showSYS(data) {\n  len = data[1];\n  len <<= 8;\n  len += data[2];\n  if (len < 4) return;\n  lt = 0;\n  //get lifetimr\n  for (i = 3; i < 7; ++i) {\n    lt <<= 8;\n    lt += data[i];\n  }\n  insertText($(\"LT\"), lt);\n  insertText($(\"LT2\"), lt);\n  SYSDATA[\"LT\"] = lt;\n  window.current_LT = lt;\n  if (len < 32) return;\n  // get softwareserial baudrate\n  ssbps = 0;\n  for (i = 32; i < 36; ++i) {\n    ssbps <<= 8;\n    ssbps += data[i];\n  }\n  insertText($(\"SSbps\"), ssbps);\n  SYSDATA[\"SSbps\"] = ssbps;\n}\n\nfunction showEEPROM(data) {\n  var str = \"\\t\";\n  for (i = 0; i < 16; ++i) {\n    str += i < 16 ? \"x\" : \"\";\n    str += i.toString(16);\n    str += \"\\t\";\n  }\n  str += \"\\n\";\n  ptr = 3;\n  for (i = 0; i < 20; ++i) {\n    str += i < 16 ? \"0\" : \"\";\n    str += i.toString(16);\n    str += \"x\";\n    str += \"\\t\";\n    for (j = 0; j < 16; ++j) {\n      var k = data[ptr++];\n      str += k < 16 ? \"0\" : \"\";\n      str += k.toString(16);\n      str += \"\\t\";\n    }\n    str += \"\\n\";\n  }\n  $(\"tx\").value = str;\n}\n\nfunction insertText(id, value) {\n  if (!id) {\n    return;\n  }\n  id.innerText = value;\n}\n\n// 顯示等待動畫\nwindow.spin = function (flag) {\n  flag\n    ? $(\"spin\").classList.remove(\"hidden\")\n    : $(\"spin\").classList.add(\"hidden\");\n};\n\n// 顯示等待動畫-無背景\nwindow.spinOnlyIcon = function (flag) {\n  if (flag) {\n    $(\"spin\").classList.remove(\"bg-black-5\");\n    $(\"spin\").classList.remove(\"hidden\");\n  } else {\n    $(\"spin\").classList.add(\"hidden\");\n    $(\"spin\").classList.add(\"bg-black-5\");\n  }\n};\n"]}