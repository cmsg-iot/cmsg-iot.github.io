{"version":3,"sources":["app.js"],"names":["window","btmMenu_previous","CORE_CMD","wifi_scan","wifi_connect","ssid","pwd","wifi_reconnect","wifi_reset","device_set_name","name","device_set_ssid","device_set_bps","baud","device_set_SSbps","sche_show","sche_add","week","time","area_arr","join","sche_save","sche_remove","index","ws_ping","CUSTOM_CMD","wifi_set_addr","addr","wifi_get_addr","system_setting","system_set","key","value","system_save","file_write","file_get","file_remove","modbus_add","st","cycle","rds","key_arr","modbus_show","$","id","document","getElementById","bindEventIfIdExist","type","func","addEventListener","switch_page","target","parentElement","classList","add","show_page","split","remove","hide_page","localStorage","setItem","location","hash","scrollTo","top","behavior","clearScheduleAdd","switchMenu","flag","updateScheduleArea","updateSchedulePage","innerHTML","data","div","table","tbody","tr","td","input","lable","span","SYSDATA","Sched","i","length","sche_data","createElement","innerText","className","onclick","e","result","confirm","getChildElementIndex","removeSchedule","append","j","disabled","shift","checked","table_week","min","div_container","k","parseInt","Stations","style","height","l","querySelectorAll","forEach","innerWidth","el","postCmd","str","jsonCmd","SENDCMD","console","log","worker","postMessage","error","createClearAllInterval","noop","firstId","setInterval","lastId","clearInterval","scanHandler","clearAllInterval","createControlOption","maxTime","op","appendChild","getOptionValue","options","selectedIndex","addSchedule","alert","area","push","filter","t","spin","setTimeout","scanWifi","timeout","res","wr","wf","res_wifi","li","btn","inputWifiPWD","prompt","v","Date","now","getFullYear","getMonth","getDate","getHours","getMinutes","getDay","reloadWeb","updateSystemPage","device","cmd","terminal_scroll","terminal_log","spinWithTime","s","node","Array","prototype","indexOf","call","children","clear","reload","preventDefault"],"mappings":"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","file":"app.064943e6.js","sourceRoot":"../src","sourcesContent":["window.btmMenu_previous = \"btmMenu_sche\";\n\nwindow.CORE_CMD = {\n  wifi_scan: \"@ap scan\",\n  wifi_connect: (ssid, pwd) => {\n    return `@ap connect [${ssid}]:[${pwd}]`;\n  },\n  wifi_reconnect: \"@ap connect reconnect\",\n  wifi_reset: \"@ap connect reset\",\n  device_set_name: (name) => {\n    return `@set device id:${name}`;\n  },\n  device_set_ssid: (ssid, pwd) => {\n    return `@set sap [${ssid}]:[${pwd}]`;\n  },\n  device_set_bps: (baud) => {\n    return `@bps: ${baud}`;\n  },\n  device_set_SSbps: (baud) => {\n    return `SS bps: ${baud}`;\n  },\n  sche_show: \"schedule show\",\n  sche_add: (week, time, area_arr) => {\n    return `schedule add Week:${week} H:M=${time} ${area_arr.join(\" \")}`;\n  },\n  sche_save: \"schedule save\",\n  sche_remove: (index) => {\n    return `schedule remove ${index}`;\n  },\n  ws_ping: \"@rssi?\",\n};\n\nwindow.CUSTOM_CMD = {\n  wifi_set_addr: (addr) => {\n    return `set recv Addr ${addr}`;\n  },\n  wifi_get_addr: \"get recv Addr\",\n  system_setting: \"system setting\",\n  system_set: (key, value) => {\n    return `system setting ${key}: ${value}`;\n  },\n  system_save: \"system setting save\",\n  file_write: \"write DNA\",\n  file_get: \"get DNA\",\n  file_remove: \"remove file DNA.dat\",\n  modbus_add: (st, cycle, rds, key_arr) => {\n    return `add station st:${st}|cycle:${cycle}|rds:${rds}|${key_arr.join(\"\")}`;\n  },\n  modbus_show: \"show station\",\n};\n\nwindow.$ = function (id) {\n  return document.getElementById(id);\n};\n\n// bind event if id exist\nwindow.bindEventIfIdExist = (id, type, func) => {\n  if (!id) {\n    return;\n  }\n  id.addEventListener(type, () => func());\n};\n\n/*------------Interface Action------------*/\n\n// bottom menu switch page\nwindow.switch_page = function (target) {\n  if (target.id === btmMenu_previous) {\n    return;\n  }\n  if (btmMenu_previous === \"home\" || btmMenu_previous === \"menu\") {\n    $(target.id).parentElement.classList.add(\"buttomMenu-selected\");\n    show_page(target.id.split(\"_\")[1]);\n  } else if (btmMenu_previous !== \"\") {\n    $(btmMenu_previous).parentElement.classList.remove(\"buttomMenu-selected\");\n    $(target.id).parentElement.classList.add(\"buttomMenu-selected\");\n    show_page(target.id.split(\"_\")[1]);\n    hide_page(btmMenu_previous.split(\"_\")[1]);\n  }\n  btmMenu_previous = target.id;\n};\n\n// show target page\nwindow.show_page = function (target) {\n  switch (target) {\n    case \"sche\":\n      localStorage.setItem(\"current_hash\", location.hash);\n      $(\"btmMenu_sche\").parentElement.classList.add(\"buttomMenu-selected\");\n      $(\"sche_editor\").classList.add(\"hidden\");\n      $(\"sche_page\").classList.remove(\"hidden\");\n      $(\"sche_list\").classList.remove(\"hidden\");\n      $(\"sche_list\").scrollTo({\n        top: 0,\n        behavior: \"smooth\",\n      });\n      $(\"sche_btn_group\").classList.remove(\"hidden\");\n      break;\n    case \"custom\":\n      localStorage.setItem(\"current_hash\", location.hash);\n      $(\"btmMenu_custom\").parentElement.classList.add(\"buttomMenu-selected\");\n      $(\"custom_page\").classList.remove(\"hidden\");\n      $(\"custom_list\").scrollTo({\n        top: 0,\n        behavior: \"instant\",\n      });\n      break;\n    case \"network\":\n      localStorage.setItem(\"current_hash\", location.hash);\n      $(\"btmMenu_network\").parentElement.classList.add(\"buttomMenu-selected\");\n      $(\"network_page\").classList.remove(\"hidden\");\n      break;\n    case \"system\":\n      localStorage.setItem(\"current_hash\", location.hash);\n      $(\"btmMenu_system\").parentElement.classList.add(\"buttomMenu-selected\");\n      $(\"system_page\").classList.remove(\"hidden\");\n      $(\"system_list\").scrollTo({\n        top: 0,\n        behavior: \"instant\",\n      });\n      break;\n    case \"terminal\":\n      localStorage.setItem(\"current_hash\", location.hash);\n      $(\"btmMenu_terminal\").parentElement.classList.add(\"buttomMenu-selected\");\n      $(\"terminal_page\").classList.remove(\"hidden\");\n      break;\n    case \"home\":\n      localStorage.setItem(\"current_hash\", location.hash);\n      $(\"menu_bottom\").classList.add(\"hidden\");\n      $(\"mask_setting\").classList.add(\"hidden\");\n      $(\"sche_page\").classList.add(\"hidden\");\n      $(\"custom_page\").classList.add(\"hidden\");\n      $(\"network_page\").classList.add(\"hidden\");\n      $(\"system_page\").classList.add(\"hidden\");\n      $(\"terminal_page\").classList.add(\"hidden\");\n      $(\"btmMenu_sche\").parentElement.classList.remove(\"buttomMenu-selected\");\n      $(\"btmMenu_custom\").parentElement.classList.remove(\"buttomMenu-selected\");\n      $(\"btmMenu_network\").parentElement.classList.remove(\n        \"buttomMenu-selected\"\n      );\n      $(\"btmMenu_system\").parentElement.classList.remove(\"buttomMenu-selected\");\n      $(\"btmMenu_terminal\").parentElement.classList.remove(\n        \"buttomMenu-selected\"\n      );\n      $(\"body\").classList.remove(\"overflow-hidden\");\n      break;\n\n    default:\n      break;\n  }\n};\n\n// hide target page\nwindow.hide_page = function (target) {\n  switch (target) {\n    case \"sche\":\n      $(\"sche_page\").classList.add(\"hidden\");\n      clearScheduleAdd();\n      break;\n    case \"custom\":\n      $(\"custom_page\").classList.add(\"hidden\");\n      break;\n    case \"network\":\n      $(\"network_page\").classList.add(\"hidden\");\n      break;\n    case \"system\":\n      $(\"system_page\").classList.add(\"hidden\");\n      break;\n    case \"terminal\":\n      $(\"terminal_page\").classList.add(\"hidden\");\n      break;\n    case \"home\":\n      $(\"menu_bottom\").classList.remove(\"hidden\");\n      $(\"mask_setting\").classList.remove(\"hidden\");\n      $(\"mask\").classList.add(\"hidden\");\n      $(\"menu\").classList.add(\"hidden\");\n      break;\n    default:\n      break;\n  }\n};\n\n// open setting menu\nbindEventIfIdExist($(\"open-menu\"), \"click\", () => {\n  switchMenu(1);\n});\n\n// close setting menu\nbindEventIfIdExist($(\"mask\"), \"click\", () => {\n  switchMenu(0);\n});\n\nwindow.switchMenu = function (flag) {\n  if (flag) {\n    window.location.hash = \"#menu\";\n    localStorage.setItem(\"current_hash\", location.hash);\n    $(\"mask\").classList.remove(\"hidden\");\n    $(\"menu\").classList.remove(\"hidden\");\n    $(\"body\").classList.add(\"overflow-hidden\");\n  } else {\n    window.location.hash = \"#home\";\n    $(\"mask\").classList.add(\"hidden\");\n    $(\"menu\").classList.add(\"hidden\");\n    $(\"body\").classList.remove(\"overflow-hidden\");\n  }\n};\n\n// switch to schedule page(show)\nbindEventIfIdExist($(\"open-sche\"), \"click\", () => {\n  window.location.hash = \"#sche\";\n});\n\nbindEventIfIdExist($(\"btmMenu_sche\"), \"click\", () => {\n  if (btmMenu_previous === \"btmMenu_sche\") return;\n  window.location.hash = \"#sche\";\n});\n\nbindEventIfIdExist($(\"sche_btn_cancel\"), \"click\", () => {\n  show_page(\"sche\");\n  clearScheduleAdd();\n});\n\n// switch to schedule page(edit)\nbindEventIfIdExist($(\"sche_btn_add\"), \"click\", () => {\n  // if (SYSDATA.STMODE !== \"停止\" && SYSDATA.STMODE !== \"手動\") {\n  //   alert(\"停止或手動模式下才可修改排程\");\n  //   return;\n  // }\n  clearScheduleAdd();\n  $(\"sche_list\").classList.add(\"hidden\");\n  $(\"sche_btn_group\").classList.add(\"hidden\");\n  $(\"sche_editor\").classList.remove(\"hidden\");\n  updateScheduleArea();\n});\n\n// update schedule page(show)\n// data-struct: [[\"W1\",11,50,2,2,0,0,0,0,0,0],[\"W1\",14,16,1,0,1,1,1,1,0,0]]\nwindow.updateSchedulePage = function () {\n  $(\"sche_list\").innerHTML = \"\";\n  let data = SYSDATA.Sched;\n  // define DOM elements\n  let div;\n  let table;\n  let tbody;\n  let tr;\n  let td;\n  let input;\n  let lable;\n  let span;\n  // create schedule elements\n  for (let i = data.length - 1; i > -1; i--) {\n    // get one schedule data\n    let sche_data = data[i];\n\n    // make 7 check box\n    let week = sche_data[0].split(\"W\")[1].split(\"\");\n\n    tbody = document.createElement(\"tbody\");\n    td = document.createElement(\"td\");\n    td.innerText = \"X\";\n    td.className = \"schedule-remove\";\n    td.onclick = (e) => {\n      // if (SYSDATA.STMODE !== \"停止\" && SYSDATA.STMODE !== \"手動\") {\n      //   alert(\"停止或手動模式下才可修改排程\");\n      //   return;\n      // }\n      let result = confirm(\"確認是否刪除排程？\");\n      if (result) {\n        let index = getChildElementIndex(\n          e.target.parentElement.parentElement.parentElement\n        );\n        let r = data.length + 1 - index;\n        index = index + (r - index) - 2;\n        removeSchedule(index);\n      }\n    };\n    tbody.append(td);\n\n    // td = document.createElement(\"td\");\n    // td.innerText = \"週\";\n    // tbody.append(td);\n\n    for (let j = 0; j < 7; j++) {\n      input = document.createElement(\"input\");\n      span = document.createElement(\"span\");\n      lable = document.createElement(\"label\");\n      td = document.createElement(\"td\");\n      input.type = \"checkbox\";\n      input.disabled = true;\n\n      if (week.length > 0 && week[0] == j + 1) {\n        week.shift();\n        input.checked = true;\n      }\n\n      if (j === 0) span.innerText = \"一\";\n      if (j === 1) span.innerText = \"二\";\n      if (j === 2) span.innerText = \"三\";\n      if (j === 3) span.innerText = \"四\";\n      if (j === 4) span.innerText = \"五\";\n      if (j === 5) span.innerText = \"六\";\n      if (j === 6) span.innerText = \"日\";\n\n      lable.append(input);\n      lable.append(span);\n      td.append(lable);\n      tbody.append(td);\n    }\n\n    let table_week = document.createElement(\"table\");\n    table_week.className = \"schedule-week\";\n    table_week.append(tbody);\n\n    // make schedule area\n    span = document.createElement(\"span\");\n    div = document.createElement(\"div\");\n    let min =\n      sche_data[2] == 0\n        ? \"00\"\n        : sche_data[2] < 10\n        ? `0${sche_data[2]}`\n        : sche_data[2];\n    span.innerText = `${sche_data[1]}:${min}`;\n    div.className = \"schedule-time\";\n    div.append(span);\n\n    let div_container = document.createElement(\"div\");\n    div_container.className = \"schedule-container\";\n    div_container.append(div);\n\n    tr = document.createElement(\"tr\");\n    tbody = document.createElement(\"tbody\");\n\n    for (let k = 0; k < parseInt(SYSDATA.Stations); k++) {\n      td = document.createElement(\"td\");\n      if (sche_data[k + 3] > 0) {\n        td.className = \"schedule-exec\";\n      } else {\n        td.className = \"schedule-close\";\n      }\n      td.innerText = `${k + 1}區`;\n      tr.append(td);\n    }\n\n    tbody.append(tr);\n    tr = document.createElement(\"tr\");\n    tr.style.height = \"4rem\";\n    for (let l = 0; l < parseInt(SYSDATA.Stations); l++) {\n      td = document.createElement(\"td\");\n      if (sche_data[l + 3] > 0) {\n        td.className = \"schedule-exec\";\n      } else {\n        td.className = \"schedule-close\";\n      }\n      td.innerText = sche_data[l + 3];\n      tr.append(td);\n    }\n\n    tbody.append(tr);\n\n    table = document.createElement(\"table\");\n    table.className = \"schedule-area\";\n    table.append(tbody);\n    div_container.append(table);\n\n    // make schedule\n    div = document.createElement(\"div\");\n    div.className = \"schedule\";\n    div.append(table_week);\n    div.append(div_container);\n\n    document.getElementById(\"sche_list\").append(div);\n  }\n};\n\n// switch to custom page\nbindEventIfIdExist($(\"open-custom\"), \"click\", () => {\n  window.location.hash = \"#custom\";\n});\nbindEventIfIdExist($(\"btmMenu_custom\"), \"click\", () => {\n  if (btmMenu_previous === \"btmMenu_custom\") return;\n  window.location.hash = \"#custom\";\n});\n\n// update custom page\n\n// switch to network page\nbindEventIfIdExist($(\"open-network\"), \"click\", () => {\n  window.location.hash = \"#network\";\n});\n\nbindEventIfIdExist($(\"btmMenu_network\"), \"click\", () => {\n  if (btmMenu_previous === \"btmMenu_network\") return;\n  window.location.hash = \"#network\";\n});\n\n// update wifi list\n\n// switch to system page\nbindEventIfIdExist($(\"open-system\"), \"click\", () => {\n  window.location.hash = \"#system\";\n});\nbindEventIfIdExist($(\"btmMenu_system\"), \"click\", () => {\n  if (btmMenu_previous === \"btmMenu_system\") return;\n  window.location.hash = \"#system\";\n});\n\n// switch to terminal page\nbindEventIfIdExist($(\"open-terminal\"), \"click\", () => {\n  window.location.hash = \"#terminal\";\n});\nbindEventIfIdExist($(\"btmMenu_terminal\"), \"click\", () => {\n  if (btmMenu_previous === \"btmMenu_terminal\") return;\n  window.location.hash = \"#terminal\";\n});\n\n// back to home page\nbindEventIfIdExist($(\"btmMenu_close\"), \"click\", () => {\n  window.location.hash = \"#home\";\n});\n\n// hide bottom menu when focus input\ndocument.querySelectorAll('input[name=\"float-input\"]').forEach((e) => {\n  // console.log(e);\n  if (window.innerWidth > 768) return;\n  e.addEventListener(\"focus\", (el) => {\n    // console.log(el.target.id + \" focus\");\n    $(\"menu_bottom\").classList.add(\"hidden\");\n  });\n  e.addEventListener(\"blur\", (el) => {\n    // console.log(el.target.id + \" blur\");\n    $(\"menu_bottom\").classList.remove(\"hidden\");\n  });\n});\n\n/*------------Command Action------------*/\n\nwindow.postCmd = function postCmd(str) {\n  if (str === \"\") return;\n  let jsonCmd = { SENDCMD: str };\n  console.log(jsonCmd);\n  if (!window.worker) {\n    console.log(\"websocket not ready...\");\n    return;\n  }\n  try {\n    window.worker.postMessage(jsonCmd);\n  } catch (error) {\n    console.log(error);\n  }\n};\n\n// clear all running interval\nwindow.createClearAllInterval = function () {\n  const noop = () => {};\n  let firstId = setInterval(noop, 0);\n\n  return () => {\n    const lastId = setInterval(noop, 0);\n    while (firstId !== lastId) {\n      firstId += 1;\n      clearInterval(firstId);\n    }\n  };\n};\n\nvar clearAllInterval = createClearAllInterval();\n\n/** Schedule */\n\n// create control option of time\nwindow.createControlOption = function (maxTime) {\n  for (let i = 0; i < SYSDATA.Stations; i++) {\n    $(`sche_add_area_${i + 1}`).innerHTML = \"\";\n    for (let j = 0; j < maxTime + 1; j++) {\n      let op = document.createElement(\"option\");\n      op.innerText = j;\n      $(`sche_add_area_${i + 1}`).appendChild(op);\n    }\n  }\n};\n\nwindow.getOptionValue = function (id) {\n  return $(id).options[$(id).selectedIndex].value;\n};\n\n// add new schedule\nwindow.addSchedule = function () {\n  let week = \"\";\n  for (let i = 0; i < 7; i++) {\n    if ($(`sche_add_w${i + 1}`).checked) {\n      week += i + 1;\n    }\n  }\n  if (week === \"\") {\n    alert(\"至少選擇一個星期\");\n    return;\n  }\n  let time = $(\"sche_add_time\").value;\n  if (time === \"\") {\n    alert(\"請選擇灑水時段\");\n    return;\n  }\n  let area = [];\n  for (let j = 0; j < SYSDATA.Stations; j++) {\n    area.push(`ST${j + 1}:` + getOptionValue(`sche_add_area_${j + 1}`));\n  }\n  if (\n    area.filter((t) => t.split(\":\")[1] > 0 && t.split(\":\")[1] <= 30).length < 1\n  ) {\n    alert(\"至少設定一區有效的灑水時間,為防止電磁閥過熱，每站上限為30分鐘。\");\n    return;\n  }\n\n  postCmd(window.CORE_CMD.sche_add(week, time, area));\n\n  clearScheduleAdd();\n  spin(1);\n\n  setTimeout(() => {\n    spin(0);\n    btmMenu_previous = \"btmMenu_sche\";\n    hide_page(\"home\");\n    show_page(\"sche\");\n    updateSchedulePage();\n    postCmd(window.CORE_CMD.sche_save);\n    alert(\"新增排程完成，若需要自動控制，請回到首頁將模式切換回自動。\");\n  }, 2000);\n};\nbindEventIfIdExist($(\"sche_btn_confirm\"), \"click\", () => {\n  addSchedule();\n});\n\n// remove schedule\nwindow.removeSchedule = function (index) {\n  spin(1);\n  postCmd(window.CORE_CMD.sche_remove(index));\n  setTimeout(() => {\n    spin(0);\n    updateSchedulePage();\n    postCmd(window.CORE_CMD.sche_save);\n  }, 2000);\n};\n\n// update schedule\nbindEventIfIdExist($(\"sche_btn_update\"), \"click\", () => {\n  $(\"sche_list\").innerHTML = \"\";\n  SYSDATA.Sched = [];\n  postCmd(window.CORE_CMD.sche_show);\n  spin(1);\n\n  setTimeout(() => {\n    postCmd(window.CUSTOM_CMD.system_setting);\n  }, 1000);\n\n  setTimeout(() => {\n    spin(0);\n    if (SYSDATA.Sched.length === 0) {\n      alert(\"無任何設定排程\");\n      return;\n    }\n    updateSchedulePage();\n  }, 2000);\n});\n\n// clear schedule edit\nwindow.clearScheduleAdd = function () {\n  for (let i = 0; i < 7; i++) {\n    $(`sche_add_w${i + 1}`).checked = false;\n  }\n  $(\"sche_add_time\").value = \"\";\n  for (let j = 0; j < SYSDATA.Stations; j++) {\n    $(`sche_add_area_${j + 1}`).selectedIndex = 0;\n  }\n};\n\n// set num of editable area\nwindow.updateScheduleArea = function () {\n  for (let i = 0; i < 8; i++) {\n    if (i < parseInt(SYSDATA.Stations)) {\n      $(`area_title_${i + 1}`).classList.remove(\"hidden\");\n      $(`area_input_${i + 1}`).classList.remove(\"hidden\");\n    } else {\n      $(`area_title_${i + 1}`).classList.add(\"hidden\");\n      $(`area_input_${i + 1}`).classList.add(\"hidden\");\n    }\n  }\n};\n\n/** Network */\n\n// scan wifi\nbindEventIfIdExist($(\"network_btn_scan\"), \"click\", () => {\n  scanWifi();\n  spin(1);\n});\nvar scanHandler;\n// 搜尋並顯示結果\nwindow.scanWifi = function () {\n  var timeout = 0;\n  var res = \"\";\n  var wr = $(\"wifi-result\");\n  var wf = $(\"network_btn_scan\");\n  res_wifi = \"\";\n  wr.innerHTML = \"\";\n  postCmd(window.CORE_CMD.wifi_scan);\n  wf.disabled = true;\n  var div = document.createElement(\"div\");\n  wr.appendChild(div);\n  scanHandler = setInterval(() => {\n    timeout += 1;\n    if (timeout >= 10) {\n      spin(0);\n      alert(\"已逾時，請重新搜尋。\");\n      clearInterval(scanHandler);\n      wr.innerHTML = \"\";\n      wf.disabled = false;\n      return;\n    }\n    if (res_wifi) {\n      spin(0);\n      res = res_wifi;\n      wr.innerHTML = \"\";\n      var res_result = res.split(\"|\");\n      res_result.forEach((e) => {\n        if (e === \"\") return;\n        var li = document.createElement(\"li\");\n        var btn = document.createElement(\"input\");\n        btn.className = \"w-btn\";\n        btn.type = \"button\";\n        btn.value = e;\n        btn.onclick = () => inputWifiPWD(e);\n        li.appendChild(btn);\n        wr.appendChild(li);\n      });\n      clearInterval(scanHandler);\n      wf.disabled = false;\n    }\n  }, 1000);\n};\n\n// connect selected wifi\nwindow.inputWifiPWD = function (e) {\n  let pwd = prompt(`SSID: ${e},Wifi密碼: `);\n  if (pwd === null) {\n    return;\n  }\n  postCmd(window.CORE_CMD.wifi_connect(e, pwd));\n};\n\n// reconnect the last connected wifi\nbindEventIfIdExist($(\"network_btn_reconnect\"), \"click\", () => {\n  postCmd(window.CORE_CMD.wifi_reconnect);\n  spin(1);\n  setTimeout(() => {\n    spin(0);\n  }, 1000);\n});\n\n// set recv socket address\nbindEventIfIdExist($(\"network_btn_set_socket\"), \"click\", () => {\n  let v = prompt(\"請輸入Socket Server位址：\");\n  if (!v) return;\n  postCmd(window.CUSTOM_CMD.wifi_set_addr(v));\n  spin(1);\n  setTimeout(() => {\n    postCmd(window.CUSTOM_CMD.wifi_get_addr);\n  }, 500);\n  setTimeout(() => {\n    spin(0);\n  }, 1000);\n});\n\n// get recv socket address\nbindEventIfIdExist($(\"network_btn_get_socket\"), \"click\", () => {\n  postCmd(window.CUSTOM_CMD.wifi_get_addr);\n  spin(1);\n  setTimeout(() => {\n    spin(0);\n  }, 500);\n});\n\n/** System */\n\n// set device name\nbindEventIfIdExist($(\"system_set_device\"), \"click\", () => {\n  let name = prompt(\"請輸入裝置名稱:\");\n  if (!name) {\n    alert(\"請輸入至少一個字\");\n    return;\n  }\n  postCmd(window.CORE_CMD.device_set_name(name));\n});\n\n// set system time\nbindEventIfIdExist($(\"system_set_time\"), \"click\", () => {\n  let time = new Date(Date.now());\n  let y = time.getFullYear();\n  let m =\n    time.getMonth() + 1 < 10 ? `0${time.getMonth() + 1}` : time.getMonth() + 1;\n  let d = time.getDate() < 10 ? `0${time.getDate()}` : time.getDate();\n  let hr = time.getHours() < 10 ? `0${time.getHours()}` : time.getHours();\n  let min =\n    time.getMinutes() < 10 ? `0${time.getMinutes()}` : time.getMinutes();\n  let week = time.getDay();\n  let now = `${y}-${m}-${d}T${hr}:${min} ${week}`;\n  let flag = confirm(`確定要更新系統時間？ ${now}`);\n  if (flag) {\n    spin(1);\n    postCmd(`set time ${now}`);\n    setTimeout(() => {\n      spin(0);\n    }, 500);\n  }\n});\n\n// set SSID\nbindEventIfIdExist($(\"system_set_ssid\"), \"click\", () => {\n  let ssid = prompt(\"請輸入SSID:\");\n  if (!ssid) {\n    alert(\"格式不符，請重試\");\n    return;\n  }\n  let pwd = prompt(\"請輸入8~16位密碼:\");\n  if (!pwd) {\n    alert(\"格式不符，請重試\");\n    return;\n  }\n  let result = confirm(`確定更改為 wifi名稱: ${ssid}, 密碼: ${pwd} ?`);\n  if (result) {\n    postCmd(window.CORE_CMD.device_set_ssid(ssid, pwd));\n  }\n});\n\n// set UART baud\nbindEventIfIdExist($(\"system_set_bps\"), \"click\", () => {\n  let baud = prompt(\"請輸入serial baud rate:\");\n  if (!baud) {\n    return;\n  }\n  postCmd(window.CORE_CMD.device_set_bps(baud));\n  spin(1);\n  setTimeout(() => {\n    spin(0);\n  }, 500);\n});\n\n// set SS bps\nbindEventIfIdExist($(\"system_set_SSbps\"), \"click\", () => {\n  let baud = prompt(\"請輸入soft serial baud rate:\");\n  if (!baud) {\n    return;\n  }\n  postCmd(window.CORE_CMD.device_set_SSbps(baud));\n  spin(1);\n  setTimeout(() => {\n    spin(0);\n  }, 500);\n});\n\n// reload fresh data\nbindEventIfIdExist($(\"system_reload\"), \"click\", () => {\n  let result = confirm(\"確認強制重新整理?\");\n  if (result) {\n    reloadWeb();\n  }\n});\n\n// update system page\nwindow.updateSystemPage = function () {\n  $(\"system_device\").innerText = SYSDATA.device;\n};\n\n/** Terminal */\n\n// send command\nbindEventIfIdExist($(\"terminal_send\"), \"click\", () => {\n  let cmd = $(\"cmd_input\").value;\n  if (cmd === \"config\") {\n    $(\"btmMenu_custom_btn\").classList.remove(\"hidden\");\n    return;\n  }\n  postCmd(cmd);\n  $(\"cmd_input\").value = \"\";\n});\n\n// clear log\nbindEventIfIdExist($(\"terminal_clear\"), \"click\", () => {\n  $(\"tx\").value = \"\";\n});\n\n// auto scroll\nbindEventIfIdExist($(\"terminal_scroll\"), \"click\", () => {\n  if (window.terminal_scroll) {\n    window.terminal_scroll = false;\n    $(\"terminal_scroll\").innerText = \"捲動: OFF\";\n    $(\"terminal_scroll\").classList.remove(\"success\");\n    $(\"terminal_scroll\").classList.add(\"default\");\n  } else {\n    window.terminal_scroll = true;\n    $(\"terminal_scroll\").innerText = \"捲動: ON\";\n    $(\"terminal_scroll\").classList.add(\"success\");\n    $(\"terminal_scroll\").classList.remove(\"default\");\n  }\n});\n\n// enable/disable log\nbindEventIfIdExist($(\"terminal_log\"), \"click\", () => {\n  if (window.terminal_log) {\n    window.terminal_log = false;\n    $(\"terminal_log\").innerText = \"Log: OFF\";\n    $(\"terminal_log\").classList.remove(\"success\");\n    $(\"terminal_log\").classList.add(\"default\");\n  } else {\n    window.terminal_log = true;\n    $(\"terminal_log\").innerText = \"Log: ON\";\n    $(\"terminal_log\").classList.add(\"success\");\n    $(\"terminal_log\").classList.remove(\"default\");\n  }\n});\n\n// reload fresh data\nbindEventIfIdExist($(\"status_light\"), \"click\", () => {\n  let result = confirm(\"確認強制重新整理?\");\n  if (result) {\n    reloadWeb();\n  }\n});\n\n// 顯示等待動畫\nwindow.spin = function (flag) {\n  flag\n    ? $(\"spin\").classList.remove(\"hidden\")\n    : $(\"spin\").classList.add(\"hidden\");\n};\n\n// 顯示等待動畫(秒數)\nwindow.spinWithTime = function (s) {\n  $(\"spin\").classList.remove(\"hidden\");\n  setTimeout(() => {\n    $(\"spin\").classList.add(\"hidden\");\n  }, s * 1000);\n};\n\nwindow.getChildElementIndex = function (node) {\n  console.log(node);\n  return Array.prototype.indexOf.call(node.parentElement.children, node);\n};\n\n// 重新整理，production中會清除localStorage\nwindow.reloadWeb = () => {\n  if ($(\"build_check\").innerText === \"build\") {\n    localStorage.clear();\n  }\n  window.location.reload();\n};\n\nwindow.addEventListener(\"hashchange\", (e) => {\n  e.preventDefault();\n  console.log(\"hashchange: \" + location.hash);\n  switch (location.hash) {\n    case \"#home\":\n      show_page(\"home\");\n      switchMenu(0);\n      btmMenu_previous = \"home\";\n      break;\n    case \"#menu\":\n      show_page(\"home\");\n      switchMenu(1);\n      btmMenu_previous = \"menu\";\n      break;\n    case \"#sche\":\n      switch_page($(\"btmMenu_sche\"));\n      $(\"sche_list\").innerHTML = \"\";\n      SYSDATA.Sched = [];\n      postCmd(window.CORE_CMD.sche_show);\n      spin(1);\n\n      setTimeout(() => {\n        postCmd(window.CUSTOM_CMD.system_setting);\n      }, 1000);\n\n      setTimeout(() => {\n        spin(0);\n        if (SYSDATA.Sched.length === 0) {\n          alert(\"無任何設定排程\");\n          return;\n        }\n        updateSchedulePage();\n      }, 2000);\n      createControlOption(30);\n      btmMenu_previous = \"btmMenu_sche\";\n      hide_page(\"home\");\n      break;\n    case \"#custom\":\n      switch_page($(\"btmMenu_custom\"));\n      btmMenu_previous = \"btmMenu_custom\";\n      hide_page(\"home\");\n      break;\n    case \"#network\":\n      switch_page($(\"btmMenu_network\"));\n      btmMenu_previous = \"btmMenu_network\";\n      hide_page(\"home\");\n      postCmd(window.CORE_CMD.ws_ping);\n      break;\n    case \"#system\":\n      switch_page($(\"btmMenu_system\"));\n      btmMenu_previous = \"btmMenu_system\";\n      hide_page(\"home\");\n      updateSystemPage();\n      break;\n    case \"#terminal\":\n      switch_page($(\"btmMenu_terminal\"));\n      btmMenu_previous = \"btmMenu_terminal\";\n      hide_page(\"home\");\n      break;\n\n    default:\n      // window.location.hash = \"#home\";\n      console.log(\"not vaild hash.\");\n      break;\n  }\n});\n"]}